<app-nav (clearSearch)="OnChanges($event)"></app-nav>
<div class="container-fluid">
  <div class="row">
    <div class="col col-2" style="background-color: rgb(182, 182, 182)">
      <div style="color: rgb(3, 124, 3)">Menu</div>
      <div style="color:honeydew"><a (click)=false>公司基本資料管理</a></div>
      <div style="color: rgba(42, 42, 233, 0.673); cursor: pointer;"><a (click)="navigateToFunding(-1)">募資紀錄管理</a></div>
      <div style="color: rgba(42, 42, 233, 0.673); cursor: pointer;"><a (click)="navigateToFunding(0)">找不到公司</a></div>
    </div>
    <div class="col col-10">
      <form class="form-inline mt-2">
        <input class="form-control mb-2 mr-sm-2 col-md-6" type="search"
          placeholder="篩選條件：統編、公司名稱、產業類別、公司地區、標籤、公司簡介、媒體報導、主要商品/服務項目" name="toSearch" aria-label="Search"
          [(ngModel)]="compToSearch.ToSearch">
        <button class="btn btn-outline-success mb-2 mr-sm-2" (click)="doSearch()">搜尋</button>
        <span *ngIf="writePermission > 0 || adminPermission > 0">
          <button class="btn btn-outline-danger mb-2 mr-sm-2" (click)="openModal(clearConfirmed)">重置確認狀態</button>
        </span>
        <button class="btn btn-outline-danger mb-2" tooltip="加新" (click)="navigateToAdd()">加入新公司</button>
        <!-- <button class="btn btn-outline-danger mb-2" tooltip="找不到公司" (click)="navigateToFunding(0)">找不到公司</button> -->

        <!-- <div class="btn-group mb-2" dropdown [autoClose]="true" container="body">
          <button id="button-nested" dropdownToggle type="button" class="btn btn-outline-info dropdown-toggle ml-2"
            aria-controls="dropdown-nested">
            Menu <span class="caret"></span>
          </button>
          <ul id="dropdown-nested" *dropdownMenu class="dropdown-menu" role="menu" aria-labelledby="button-nested">
            <li role="menuitem"><a class="dropdown-item" href="">公司基本資料管理</a></li>

            <li role="menuitem" dropdown triggers="mouseover" placement="right" container="body">
              <a dropdownToggle class="dropdown-item dropdown-toggle" (click)="false">募資紀錄管理<span class="caret"></span></a>
              <ul *dropdownMenu class="dropdown-menu" role="menu">
                <li role="menuitem"><a class="dropdown-item" (click)="navigateToFunding(0)">找不到公司</a></li>
              </ul>
            </li>
          </ul>
        </div> -->

      </form>

      <ng-template #clearConfirmed>
        <div class="modal-header">
          <h4 class="modal-title pull-left">重置公司資料更新狀態</h4>
          <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          確認重置狀態？
        </div>
        <div class="modal-footer">
          <button class="btn btn-danger" (click)="clearConfirmedCompany()"><i class="fa fa-send"></i> 確定</button>
        </div>
      </ng-template>

      <table class="table table-hover table-sm">
        <thead class="thead-dark">
          <tr>
            <!-- COMP_ID -->
            <th class="centered-th mx-auto p-2 perc10" scope="col" *ngIf="compToSearch.ArrangeFor === 'id'"
              (click)="changeArrange('id')">
              <span *ngIf="compToSearch.Arrange === 'ASC'">
                編號<i class="fa fa-sort-asc ml-1"></i>
              </span>
              <span *ngIf="compToSearch.Arrange === 'DESC'">
                編號<i class="fa fa-sort-desc ml-1"></i>
              </span>
            </th>
            <th class="centered-th mx-auto p-2 perc10" scope="col" *ngIf="compToSearch.ArrangeFor !== 'id'"
              (click)="changeArrange('id')">
              編號 <i class="fa fa-unsorted"></i>
            </th>
            <!-- TONPIEN -->
            <th class="centered-th mx-auto p-2 perc10" scope="col" *ngIf="compToSearch.ArrangeFor === 'comp_banno'"
              (click)="changeArrange('comp_banno')">
              <span *ngIf="compToSearch.Arrange === 'ASC'">
                統編<i class="fa fa-sort-asc ml-1"></i>
              </span>
              <span *ngIf="compToSearch.Arrange === 'DESC'">
                統編<i class="fa fa-sort-desc ml-1"></i>
              </span>
            </th>
            <th class="centered-th mx-auto p-2 perc10" scope="col" *ngIf="compToSearch.ArrangeFor !== 'comp_banno'"
              (click)="changeArrange('comp_banno')">
              統編 <i class="fa fa-unsorted"></i>
            </th>

            <!-- COMP_NAME -->
            <th class="centered-th mx-auto p-2 perc20" scope="col" *ngIf="compToSearch.ArrangeFor === 'comp_name'"
              (click)="changeArrange('comp_name')">
              <span *ngIf="compToSearch.Arrange === 'ASC'">
                公司名稱<i class="fa fa-sort-asc ml-1"></i>
              </span>
              <span *ngIf="compToSearch.Arrange === 'DESC'">
                公司名稱<i class="fa fa-sort-desc ml-1"></i>
              </span>
            </th>
            <th class="centered-th mx-auto p-2 perc20" scope="col" *ngIf="compToSearch.ArrangeFor !== 'comp_name'"
              (click)="changeArrange('comp_name')">
              公司名稱 <i class="fa fa-unsorted"></i>
            </th>

            <!-- COMP_LOCATION -->
            <th class="centered-th mx-auto p-2 perc30" scope="col" *ngIf="compToSearch.ArrangeFor === 'comp_location'"
              (click)="changeArrange('comp_location')">
              <span *ngIf="compToSearch.Arrange === 'ASC'">
                公司地址<i class="fa fa-sort-asc ml-1"></i>
              </span>
              <span *ngIf="compToSearch.Arrange === 'DESC'">
                公司地址<i class="fa fa-sort-desc ml-1"></i>
              </span>
            </th>
            <th class="centered-th mx-auto p-2 perc30" scope="col" *ngIf="compToSearch.ArrangeFor !== 'comp_location'"
              (click)="changeArrange('comp_location')">
              公司地址 <i class="fa fa-unsorted"></i>
            </th>

            <!-- COMP_CONTACT -->
            <th class="centered-th mx-auto p-2 perc15" scope="col" *ngIf="compToSearch.ArrangeFor === 'comp_contact'"
              (click)="changeArrange('comp_contact')">
              <span *ngIf="compToSearch.Arrange === 'ASC'">
                聯絡人<i class="fa fa-sort-asc ml-1"></i>
              </span>
              <span *ngIf="compToSearch.Arrange === 'DESC'">
                聯絡人<i class="fa fa-sort-desc ml-1"></i>
              </span>
            </th>
            <th class="centered-th mx-auto p-2 perc10" scope="col" *ngIf="compToSearch.ArrangeFor !== 'comp_contact'"
              (click)="changeArrange('comp_contact')">
              聯絡人 <i class="fa fa-unsorted"></i>
            </th>

            <th scope="col" class="text-center perc15">管理</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let list of compToList" [class.table-success]="list.confirmed == 1">
            <td (click)="openModal(template)">{{list.id}}</td>
            <td (click)="openModal(template)">{{list.comp_banno}}</td>
            <td (click)="openModal(template)">{{list.comp_name}}</td>
            <td (click)="openModal(template)">{{list.comp_location}}</td>
            <td (click)="openModal(template)">{{list.comp_contact}}</td>
            <td class="text-center">

              <button type="button" class="btn btn-outline-info mr-2" tooltip="展開" (click)="openModal(template)"><i
                  class="fa fa-folder-open-o"></i></button>
              <button type="button" class="btn btn-outline-success mr-2" tooltip="募資"
                (click)="navigateToFunding(list.id)"><i class="fa fa-money"></i></button>
              <span *ngIf="writePermission > 0 || adminPermission > 0">
                <button class="btn btn-outline-primary" tooltip="編輯" (click)="navigateToEdit(list)"><i
                    class="fa fa-edit"></i></button>
                <button class="btn btn-outline-warning ml-2" tooltip="送出" (click)="openModal(confirmSend)"><i
                    class="fa fa-send"></i></button>
                <button class="btn btn-outline-danger ml-2" tooltip="刪除" (click)="openModal(confirmDelete)"><i
                    class="fa fa-remove"></i></button>
              </span>
            </td>

            <ng-template #confirmSend>
              <div class="modal-header">
                <h4 class="modal-title pull-left">確認送出</h4>
                <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                請再次確認該筆資料是否正確？
              </div>
              <div class="modal-footer">
                <button class="btn btn-danger" (click)="confirmCompany(list.id)"><i class="fa fa-send"></i> 確認</button>
              </div>
            </ng-template>

            <ng-template #confirmDelete>
              <div class="modal-header">
                <h4 class="modal-title pull-left">刪除公司</h4>
                <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                請再次確認該筆資料是否正確？
              </div>
              <div class="modal-footer">
                <button class="btn btn-danger" (click)="deleteCompany(list.id)"><i class="fa fa-send"></i> 確認</button>
              </div>
            </ng-template>

            <ng-template #template>
              <div class="modal-header">
                <h4 class="modal-title pull-left">{{list.comp_name}}</h4>
                <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">

                <div class="alert alert-dark m-2" role="alert">
                  <strong>編號</strong> : {{list.id}}
                </div>

                <div class="alert alert-dark m-2" role="alert">
                  <strong>統編</strong> : {{list.comp_banno}}
                </div>

                <div class="alert alert-dark m-2" role="alert">
                  <strong>產業類別</strong> : {{list.comp_industry}}
                </div>

                <div class="alert alert-dark m-2" role="alert">
                  <strong>公司地址</strong> : {{list.comp_location}}
                </div>

                <div class="alert alert-dark m-2" role="alert">
                  <strong>公司地區</strong> : {{list.comp_area}}
                </div>

                <div class="alert alert-dark m-2" role="alert">
                  <strong>資本額</strong> : {{list.comp_amount}}
                </div>

                <div class="alert alert-dark m-2" role="alert">
                  <strong>員工人數</strong> : {{list.comp_employee}}
                </div>

                <div class="alert alert-dark m-2" role="alert">
                  <strong>聯絡人</strong> : {{list.comp_contact}}
                </div>

                <div class="alert alert-success m-2" role="alert">
                  <strong>電話</strong> : {{list.comp_tel}}
                </div>

                <div class="alert alert-success m-2" role="alert">
                  <strong>傳真</strong> : {{list.comp_fax}}
                </div>

                <div class="alert alert-dark m-2" role="alert">
                  <strong>公司網址</strong> : {{list.comp_url}}
                </div>

                <div class="alert alert-dark m-2" role="alert">
                  <strong>粉絲專頁(FB)</strong> : {{list.comp_extra_url}}
                </div>

                <div class="alert alert-dark m-2" role="alert">
                  <strong>標籤(Yourator)</strong> : {{list.comp_tag}}
                </div>

                <div class="card m-2 border-info">
                  <div class="card-header">
                    公司簡介
                  </div>
                  <div class="card-body">
                    {{list.comp_desc}}
                  </div>
                </div>

                <div class="card m-2 border-info">
                  <div class="card-header">
                    媒體報導
                  </div>
                  <div class="card-body">
                    {{list.comp_media_report}}
                  </div>
                </div>

                <div class="card m-2 border-info">
                  <div class="card-header">
                    主要商品/服務項目
                  </div>
                  <div class="card-body">
                    {{list.comp_business}}
                  </div>
                </div>
                <div class="card m-2 border-info">
                  <div class="card-header">
                    關鍵字
                  </div>
                  <div class="card-body">
                    {{list.comp_keyword}}
                  </div>
                </div>
                <div class="alert alert-success m-2" role="alert">
                  <strong>額外的數據</strong> : {{list.extra}}
                </div>

              </div>
            </ng-template>

          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="container" style="margin-top: 25px">
  <div class="row">
    <div class="col col-lg-10">
      <pagination [boundaryLinks]="true" [totalItems]="paging.TotalCount" [(ngModel)]="paging.CurrentPage" [maxSize]=10
        (pageChanged)="pageChanged($event)" previousText="&lsaquo;" nextText="&rsaquo;" firstText="&laquo;"
        lastText="{{paging.TotalPages}} &raquo;">
      </pagination>
    </div>
    <div class="col col-lg-2">
      <div class="form-group form-inline ml-2">
        <input class="form-control form-control-sm col-md-4" type="text" name="newpage" placeholder="Go to page"
          [(ngModel)]="gotopage">
        <button class="form-control form-control-sm btn btn-outline-primary ml-2" (click)="goToPage()"> <i
            class="fa fa-search"></i> 提交</button>
      </div>
    </div>
  </div>
</div>